<!DOCTYPE html>
<html lang="pt-br"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/template}">
<head>
    <title>Meus Processos Atribuídos</title>

    <style layout:fragment="estilos">
        a { text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>

<body>

<div layout:fragment="conteudo">

    <h1 class="mb-3">Meus Processos Atribuídos</h1>
    <p class="mb-4">Aqui estão todos os processos designados a você como relator.</p>

    <div class="card shadow p-4 mb-4">

        <table class="table table-bordered table-striped align-middle">
            <thead class="table-secondary">
            <tr>
                <th>Nº Processo</th>
                <th>Assunto</th>
                <th>Aluno Interessado</th>
                <th>Data de Distribuição</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
            </thead>

            <tbody>
            <tr th:if="${processosAtribuidos.isEmpty()}">
                <td colspan="6" class="text-center">
                    Você não possui processos atribuídos no momento.
                </td>
            </tr>

            <tr th:each="proc : ${processosAtribuidos}">
                <td th:text="${proc.numero}">001/2025</td>
                <td th:text="${proc.assunto.nome}">Reabertura de Matrícula</td>
                <td th:text="${proc.interessado.usuario.nome}">José da Silva</td>
                <td th:text="${#temporals.format(proc.dataDistribuicao, 'dd/MM/yyyy')}">
                    01/11/2025
                </td>
                <td>
                    <span class="badge"
                          th:classappend="${proc.statusProcesso.name() == 'DISPONIVEL'} ? 'bg-success' : 'bg-warning text-dark'"
                          th:text="${proc.statusProcesso}">
                    </span>
                </td>
                <td>
                    <a th:if="${proc.statusProcesso.name() == 'DISTRIBUIDO' or proc.statusProcesso.name() == 'DISPONIVEL'}"
                       th:href="@{/professor/processo/{id}/parecer(id=${proc.id})}"
                       class="btn btn-primary btn-sm">
                        <i class="bi bi-pencil-square"></i> Emitir Parecer
                    </a>

                    <span th:if="${proc.statusProcesso.name() == 'EM_PAUTA' or proc.statusProcesso.name() == 'JULGADO'}"
                          class="text-muted small">
                        <i class="bi bi-lock-fill"></i> Bloqueado
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <a sec:authorize="hasRole('COORDENADOR')"
       th:href="@{/coordenador/home-coordenador}"
       class="btn btn-secondary">
        Voltar ao Painel
    </a>

    <a sec:authorize="hasRole('PROFESSOR') and !hasRole('COORDENADOR')"
       th:href="@{/professor/home-professor}"
       class="btn btn-secondary">
        Voltar ao Painel
    </a>

</div>

</body>
</html>