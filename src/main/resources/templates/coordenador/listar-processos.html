<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Consultar Processos</title>
</head>
<body>

<h1>Consultar Processos</h1>

<form th:action="@{/coordenador/listar-processo}" method="get">

    <label for="filtroStatus">Filtrar por Status:</label><br>
    <select id="filtroStatus" name="status">
        <option value="">Todos os status</option>
        <option th:each="stat : ${T(br.edu.ifpb.pautax.domain.enums.StatusProcesso).values()}"
                th:value="${stat}"
                th:text="${stat}"
                th:selected="${statusSelecionado != null and statusSelecionado.name() == stat.name()}">
        </option>
    </select>
    <br><br>

    <label for="filtroAluno">Filtrar por Aluno:</label><br>
    <select id="filtroAluno" name="idAluno">
        <option value="">Todos os alunos</option>
        <option th:each="aluno : ${listaAlunos}"
                th:value="${aluno.id}"
                th:text="${aluno.usuario.nome}" th:selected="${alunoSelecionado} != null and ${alunoSelecionado} == ${aluno.id}">
        </option>
    </select>
    <br><br>

    <label for="filtroRelator">Filtrar por Relator:</label><br>
    <select id="filtroRelator" name="idRelator">
        <option value="">Todos os relatores</option>
        <option th:each="prof : ${listaProfessores}"
                th:value="${prof.id}"
                th:text="${prof.usuario.nome}"
                th:selected="${relatorSelecionado} != null and ${relatorSelecionado} == ${prof.id}">
        </option>
    </select>
    <br><br>

    <button type="submit">Buscar</button>
    <a th:href="@{/coordenador/listar-processo}">Limpar Filtros</a>
</form>

<hr>

<h3>Listagem de Processos</h3>

<table border="1" cellpadding="5" cellspacing="0">
    <thead>
    <tr>
        <th>ID</th>
        <th>Número</th>
        <th>Assunto</th>
        <th>Interessado (Aluno)</th>
        <th>Relator</th>
        <th>Status</th>
        <th>Data de Registro</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="proc : ${listaProcessos}"> <td th:text="${proc.id}"></td>
        <td th:text="${proc.numero}"></td>
        <td th:text="${proc.assunto.nome}"></td>
        <td th:text="${proc.interessado.usuario.nome}"></td> <td th:text="${proc.relator != null ? proc.relator.usuario.nome : 'Pendente'}"></td>
        <td th:text="${proc.statusProcesso}"></td>
        <td th:text="${#temporals.format(proc.dataRegistro, 'dd/MM/yyyy')}"></td>
    </tr>
    <tr th:if="${#lists.isEmpty(listaProcessos)}">
        <td colspan="7">Nenhum processo encontrado com os filtros selecionados.</td>
    </tr>
    </tbody>
</table>

<br>
<a th:href="@{/coordenador/home-coordenador}">Voltar para o Início</a>

</body>
</html>